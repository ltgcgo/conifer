"use strict";let w=new TextEncoder,x=" \x1B[1;30m█\x1B[0;37m█\x1B[1;37m█\x1B[0m",$=w.encode("\x1B[H\x1B[2J\x1B[3J"),s=e=>`\x1B[${e>>3};3${e&7}m█`,f=e=>`${s(e>>4)}${s(e&15)}`,m=new Uint8Array(1),n=await Deno.open(Deno.args[0]),i=(await n.stat()).size,a=await n.seek(0,0),p=new Uint8Array(32768),r,u,t,c=1;for(;a<i;){let{columns:e,rows:d}=Deno.consoleSize(),l=(e*d>>1)-20;r=p.subarray(0,l),t=await n.read(r),u=r.subarray(0,t);let o=x.slice();for(let b of u)o+=f(b);o+=`${" ".repeat(l-t<<1)}\x1B[0mW:${`${e}`.padEnd(3," ")} H:${`${d}`.padEnd(2," ")} E0 ${`${c}`.padStart(6,"0")}/${`${Math.ceil(i/t)}`.padStart(6,"0")} L:${t}`,Deno.stdout.write($),Deno.stdout.write(w.encode(o)),await Deno.stdin.read(m),a=await n.seek(a+t,0),c++}Deno.stdout.write($);console.debug(`Conifer 4-bit export ended at ${a}/${i}.`);
